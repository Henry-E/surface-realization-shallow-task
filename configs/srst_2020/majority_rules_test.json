{
    "experiment_info": {
        "exp_type": "srst_2020",
        "run_name": "majority_rules_test",
        "available_actions": [
            "shuffle",
            "preprocess",
            "train",
            "translate",
            "format",
            "eval"
        ],
        "actions_to_take": [
            "src_and_tgt",
            "translate",
            "format",
            "eval"
        ],
        "last_run_datetime": "12-Oct_04-29",
        "this_run_config_file": "/home/henrye/projects/surface-realization-shallow-task/configs/srst_2020/augmented_data_and_ewt_08-Oct_15-01.json",
        "root_dir": "/home/henrye/projects/surface-realization-shallow-task",
        "opennmt_dir": "/home/henrye/downloads/henrye_OpenNMT-py",
        "preprocess_sub_dir": "augmented_data_and_ewt_09-Oct_03-43",
        "train_sub_dir": "augmented_data_and_ewt_09-Oct_10-02",
        "best_model_file": "sr_acc_95.51_step_411500.pt",
        "eval_sub_dir": null
    },
    "src_and_tgt": [
        "python",
        "{root_dir}/modules/create_source_and_target.py",
        "-i",
        "en_ewt-ud-dev.conllu",
        "-o",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}",
        "--form_suggestions_file_name",
        "{root_dir}/inflection_dicts/18th_october_tests/lemma_form_dict_sorted.json",
        "--train_set_repeats",
        "0"
    ],
    "shuffle": [
        "paste -d '\t' {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.src {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.tgt > {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.temp; shuffle-big-file --input_file {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.temp --batch_size 250000 --output_file {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.out; awk -F '\t' '{{ print $1 > \"{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.src\"; print $2 > \"{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.tgt\"}}' {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.out; rm -f {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.out; rm -f {root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.temp"
    ],
    "preprocess": [
        "python",
        "{opennmt_dir}/preprocess.py",
        "-train_src",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.src",
        "-train_tgt",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/train.tgt",
        "-valid_src",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/dev.src",
        "-valid_tgt",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/dev.tgt",
        "-save_data",
        "{root_dir}/experiments/preprocess/{exp_type}/{preprocess_sub_dir}/sr",
        "-dynamic_dict",
        "-share_vocab",
        "-shard_size",
        "125000",
        "-src_seq_length",
        "150",
        "-tgt_seq_length",
        "100",
        "-src_vocab",
        "{root_dir}/vocabs/synthetic/vocab_min_10_total_89233.txt",
        "-tgt_vocab",
        "{root_dir}/vocabs/synthetic/vocab_min_10_total_89233.txt",
        "-src_vocab_size",
        "89233",
        "-tgt_vocab_size",
        "89233"
    ],
    "train": [
        "python",
        "{opennmt_dir}/train.py",
        "-data",
        "{root_dir}/experiments/preprocess/{exp_type}/{preprocess_sub_dir}/sr",
        "-save_model",
        "{root_dir}/experiments/train/{exp_type}/{train_sub_dir}/sr",
        "--log_file",
        "{root_dir}/experiments/train/{exp_type}/{train_sub_dir}/sr.log.txt",
        "--gpu_ranks",
        "0",
        "1",
        "--world_size",
        "2",
        "--tensorboard",
        "--tensorboard_log_dir",
        "{root_dir}/experiments/tensorboard/{exp_type}/{tensorboard_sub_dir}",
        "--keep_checkpoint",
        "10",
        "--optim",
        "adam",
        "--learning_rate",
        "0.001",
        "--encoder_type",
        "brnn",
        "--batch_size",
        "32",
        "--share_embeddings",
        "--copy_attn",
        "--copy_attn_force",
        "--layers",
        "2",
        "--word_vec_size",
        "300",
        "--rnn_size",
        "900",
        "--report_every",
        "500",
        "--valid_steps",
        "500",
        "--save_checkpoint",
        "500",
        "--train_steps",
        "550000",
        "--start_decay_steps",
        "600000",
        "--decay_steps",
        "750"
    ],
    "translate": [
        "python",
        "{opennmt_dir}/translate.py",
        "-model",
        "{root_dir}/experiments/train/{exp_type}/{train_sub_dir}/{best_model_file}",
        "-src",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/dev.src",
        "-tgt",
        "{root_dir}/experiments/src_and_tgt/{exp_type}/{src_and_tgt_sub_dir}/dev.tgt",
        "-output",
        "{root_dir}/experiments/translate/{exp_type}/{translate_sub_dir}/sr.pred.txt",
        "-block_ngram_repeat",
        "1",
        "-batch_size",
        "1",
        "-gpu",
        "0",
        "-dynamic_dict",
        "-share_vocab",
        "-replace_unk",
        "--n_best",
        "50",
        "-beam_size",
        "50"
    ],
    "format": [
        "python",
        "{root_dir}/modules/format.py",
        "--conll_sents_file_name",
        "{root_dir}/data/srst_2020/ewt_source/en_ewt-ud-dev.conllu",
        "--gen_sents_file_name",
        "{root_dir}/experiments/translate/{exp_type}/{translate_sub_dir}/sr.pred.txt",
        "-o",
        "{root_dir}/experiments/format/{exp_type}/{format_sub_dir}",
        "--n_best",
        "50"
    ],
    "eval": [
        "python",
        "{root_dir}/modules/eval_Py3.py",
        "{root_dir}/experiments/format/{exp_type}/{format_sub_dir}",
        "{root_dir}/data/srst_2020/ewt_dev_sents"
    ],
    "src_and_tgt_debug": "python -m ipdb /home/henrye/projects/surface-realization-shallow-task/modules/create_source_and_target.py -i en_ewt-ud-train.conllu en_ewt-ud-dev.conllu /home/henrye/projects/surface-realization-shallow-task/data/synthetic_2020/wikitext/wikitext_filtered.conllu /home/henrye/projects/surface-realization-shallow-task/data/synthetic_2020/cnn/cnn_filtered.conllu -o /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01 --form_suggestions_file_name /home/henrye/projects/surface-realization-shallow-task/inflection_dicts/18th_october_tests/lemma_form_dict_sorted.json --train_set_repeats 60 --synthetic_data_repeats 8",
    "preprocess_debug": "python -m ipdb /home/henrye/downloads/henrye_OpenNMT-py/preprocess.py -train_src /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/train.src -train_tgt /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/train.tgt -valid_src /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/dev.src -valid_tgt /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/dev.tgt -save_data /home/henrye/projects/surface-realization-shallow-task/experiments/preprocess/srst_2020/augmented_data_and_ewt_09-Oct_03-43/sr -dynamic_dict -share_vocab -shard_size 125000 -src_seq_length 150 -tgt_seq_length 100 -src_vocab /home/henrye/projects/surface-realization-shallow-task/vocabs/synthetic/vocab_min_10_total_89233.txt -tgt_vocab /home/henrye/projects/surface-realization-shallow-task/vocabs/synthetic/vocab_min_10_total_89233.txt -src_vocab_size 89233 -tgt_vocab_size 89233",
    "train_debug": "python -m ipdb /home/henrye/downloads/henrye_OpenNMT-py/train.py -data /home/henrye/projects/surface-realization-shallow-task/experiments/preprocess/srst_2020/augmented_data_and_ewt_09-Oct_03-43/sr -save_model /home/henrye/projects/surface-realization-shallow-task/experiments/train/srst_2020/augmented_data_and_ewt_09-Oct_10-02/sr --log_file /home/henrye/projects/surface-realization-shallow-task/experiments/train/srst_2020/augmented_data_and_ewt_09-Oct_10-02/sr.log.txt --gpu_ranks 0 1 --world_size 2 --tensorboard --tensorboard_log_dir /home/henrye/projects/surface-realization-shallow-task/experiments/tensorboard/srst_2020/augmented_data_and_ewt_09-Oct_10-02 --keep_checkpoint 10 --optim adam --learning_rate 0.001 --encoder_type brnn --batch_size 32 --share_embeddings --copy_attn --copy_attn_force --layers 2 --word_vec_size 300 --rnn_size 900 --report_every 500 --valid_steps 500 --save_checkpoint 500 --train_steps 550000 --start_decay_steps 600000 --decay_steps 750",
    "translate_debug": "python -m ipdb /home/henrye/downloads/henrye_OpenNMT-py/translate.py -model /home/henrye/projects/surface-realization-shallow-task/experiments/train/srst_2020/augmented_data_and_ewt_09-Oct_10-02/sr_acc_95.51_step_411500.pt -src /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/dev.src -tgt /home/henrye/projects/surface-realization-shallow-task/experiments/src_and_tgt/srst_2020/augmented_data_and_ewt_08-Oct_15-01/dev.tgt -output /home/henrye/projects/surface-realization-shallow-task/experiments/translate/srst_2020/augmented_data_and_ewt_12-Oct_04-29/sr.pred.txt -block_ngram_repeat 1 -batch_size 1 -gpu 0 -dynamic_dict -share_vocab -replace_unk --n_best 50 -beam_size 50",
    "format_debug": "python -m ipdb /home/henrye/projects/surface-realization-shallow-task/modules/format.py --conll_sents_file_name /home/henrye/projects/surface-realization-shallow-task/data/srst_2020/ewt_source/en_ewt-ud-dev.conllu --gen_sents_file_name /home/henrye/projects/surface-realization-shallow-task/experiments/translate/srst_2020/augmented_data_and_ewt_12-Oct_04-29/sr.pred.txt -o /home/henrye/projects/surface-realization-shallow-task/experiments/format/srst_2020/augmented_data_and_ewt_12-Oct_05-13 --n_best 50",
    "eval_debug": "python -m ipdb /home/henrye/projects/surface-realization-shallow-task/modules/eval_Py3.py /home/henrye/projects/surface-realization-shallow-task/experiments/format/srst_2020/augmented_data_and_ewt_12-Oct_05-13 /home/henrye/projects/surface-realization-shallow-task/data/srst_2020/ewt_dev_sents"
}
